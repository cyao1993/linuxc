# 线程间同步(Mutext, Condition Variable)

## Mutext(互斥锁)

写程序时应该尽量避免同时获得多个锁,如果一定有必要这么做按下面原则

- 如果所有线程在需要多个锁时都按相同的先后顺序(常见的是按Mutex变量的地址顺序)获得锁, 则不会出现死锁

比如一个程序中用到锁 1、锁 2、锁 3,它们所对应的Mutex 变量的地址
是 锁1< 锁2< 锁3,那么所有线程在需要同时获得 2 个或 3 个锁时都应该按锁1、锁2、锁 3的顺序获得

- 如果要为所有的锁确定一个先后顺序比较困难,则应该尽量使用 pthread_mutex_trylock调用代替pthread_mutex_lock调用,以免死锁.

## Condition Variable

线程A需要某个条件成立才能继续往下执行,现在这个条件不成立,线程A就阻塞等待,而线程B在执行过程中是这个条件成立了,就唤醒线程A继续执行

## Semaphore(信号量)

- Mutex变量是非0即1,可看作一种资源是否可用
- semaphore和mutex类似,和mutex不同的是semaphore可以大于1,不仅可以用于同一个进程的线程间同步,也可以用于不同进程间的线程同步
